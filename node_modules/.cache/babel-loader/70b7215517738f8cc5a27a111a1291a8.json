{"ast":null,"code":"import React, { Component } from 'react';\nimport Finance from 'financejs';\n\nclass GoalSeek extends React.Component {\n  constructor() {\n    //\n    super();\n    this.finance = new Finance();\n  }\n\n  seek(initialValue, dataTable, targetValue) {\n    const n = dataTable.length; // number of periods\n\n    let rate = .1; // initial guess for the rate of return\n    // calculate the net present value of the investments at the initial guess for the rate of return\n\n    let fv = this.calcfv(rate, initialValue, dataTable, n);\n    console.log(\"initialValue:\", initialValue, \" fv:\", fv, \" targetValue:\", targetValue); // iterate until the net present value is close enough to the target value, or until the maximum number of iterations is reached\n\n    const tolerance = 1e-4; // tolerance for the error between the net present value and the target value\n\n    const maxIterations = 1e+4; // maximum number of iterations\n\n    let iterations = 0; // current number of iterations\n\n    while (Math.abs(fv - targetValue) > tolerance && iterations < maxIterations) {\n      // adjust the rate of return based on the error between the net present value and the target value\n      rate -= (targetValue - fv) / fv; // recalculate the net present value at the new rate of return\n\n      fv = this.calcfv(rate, dataTable, n);\n      console.log(fv);\n      iterations++;\n    }\n\n    if (iterations === maxIterations) {\n      throw new Error('Could not find a solution within the maximum number of iterations');\n    }\n\n    return rate;\n  }\n\n  calcfv(r, initialValue, dataTable, n) {\n    let fv = initialValue;\n\n    for (var i = 0; i < n; i++) {\n      fv = this.finance.FV(r, dataTable[i].balEOY - dataTable[i].mngFee, 1);\n    }\n\n    return fv;\n  }\n\n}\n\nexport default GoalSeek;","map":{"version":3,"sources":["/Users/jonwretlind/Dropbox (1)/__Jon/__Jon Project Files/Code Projects/Incisic/incisic-app/src/helpers/goalseek.js"],"names":["React","Component","Finance","GoalSeek","constructor","finance","seek","initialValue","dataTable","targetValue","n","length","rate","fv","calcfv","console","log","tolerance","maxIterations","iterations","Math","abs","Error","r","i","FV","balEOY","mngFee"],"mappings":"AACA,OAAOA,KAAP,IAAgBC,SAAhB,QAAiC,OAAjC;AACA,OAAOC,OAAP,MAAoB,WAApB;;AAEA,MAAMC,QAAN,SAAuBH,KAAK,CAACC,SAA7B,CAAuC;AACrCG,EAAAA,WAAW,GAAG;AACZ;AACA;AACA,SAAKC,OAAL,GAAe,IAAIH,OAAJ,EAAf;AACD;;AACDI,EAAAA,IAAI,CAACC,YAAD,EAAeC,SAAf,EAA0BC,WAA1B,EAAuC;AACzC,UAAMC,CAAC,GAAGF,SAAS,CAACG,MAApB,CADyC,CACZ;;AAC7B,QAAIC,IAAI,GAAG,EAAX,CAFyC,CAEzB;AAEhB;;AACA,QAAIC,EAAE,GAAG,KAAKC,MAAL,CAAYF,IAAZ,EAAkBL,YAAlB,EAAgCC,SAAhC,EAA2CE,CAA3C,CAAT;AACAK,IAAAA,OAAO,CAACC,GAAR,CAAY,eAAZ,EAA6BT,YAA7B,EAA2C,MAA3C,EAAmDM,EAAnD,EAAuD,eAAvD,EAAwEJ,WAAxE,EANyC,CAQzC;;AACA,UAAMQ,SAAS,GAAG,IAAlB,CATyC,CAShB;;AACzB,UAAMC,aAAa,GAAG,IAAtB,CAVyC,CAUZ;;AAC7B,QAAIC,UAAU,GAAG,CAAjB,CAXyC,CAWpB;;AACrB,WAAOC,IAAI,CAACC,GAAL,CAASR,EAAE,GAAGJ,WAAd,IAA6BQ,SAA7B,IAA0CE,UAAU,GAAGD,aAA9D,EAA6E;AAC3E;AACAN,MAAAA,IAAI,IAAI,CAACH,WAAW,GAAGI,EAAf,IAAqBA,EAA7B,CAF2E,CAI3E;;AACAA,MAAAA,EAAE,GAAG,KAAKC,MAAL,CAAYF,IAAZ,EAAkBJ,SAAlB,EAA6BE,CAA7B,CAAL;AACAK,MAAAA,OAAO,CAACC,GAAR,CAAYH,EAAZ;AACAM,MAAAA,UAAU;AACX;;AAED,QAAIA,UAAU,KAAKD,aAAnB,EAAkC;AAChC,YAAM,IAAII,KAAJ,CAAU,mEAAV,CAAN;AACD;;AACD,WAAOV,IAAP;AAED;;AAEDE,EAAAA,MAAM,CAACS,CAAD,EAAIhB,YAAJ,EAAkBC,SAAlB,EAA6BE,CAA7B,EAAgC;AACpC,QAAIG,EAAE,GAAGN,YAAT;;AACA,SAAK,IAAIiB,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGd,CAApB,EAAuBc,CAAC,EAAxB,EAA4B;AAC1BX,MAAAA,EAAE,GAAG,KAAKR,OAAL,CAAaoB,EAAb,CAAgBF,CAAhB,EAAmBf,SAAS,CAACgB,CAAD,CAAT,CAAaE,MAAb,GAAsBlB,SAAS,CAACgB,CAAD,CAAT,CAAaG,MAAtD,EAA8D,CAA9D,CAAL;AACD;;AACD,WAAOd,EAAP;AACD;;AAzCoC;;AA4CvC,eAAeV,QAAf","sourcesContent":["\nimport React, { Component } from 'react';\nimport Finance from 'financejs';\n\nclass GoalSeek extends React.Component {\n  constructor() {\n    //\n    super();\n    this.finance = new Finance();\n  }\n  seek(initialValue, dataTable, targetValue) {\n    const n = dataTable.length;  // number of periods\n    let rate = .1;  // initial guess for the rate of return\n\n    // calculate the net present value of the investments at the initial guess for the rate of return\n    let fv = this.calcfv(rate, initialValue, dataTable, n);\n    console.log(\"initialValue:\", initialValue, \" fv:\", fv, \" targetValue:\", targetValue);\n\n    // iterate until the net present value is close enough to the target value, or until the maximum number of iterations is reached\n    const tolerance = 1e-4;  // tolerance for the error between the net present value and the target value\n    const maxIterations = 1e+4;  // maximum number of iterations\n    let iterations = 0;  // current number of iterations\n    while (Math.abs(fv - targetValue) > tolerance && iterations < maxIterations) {\n      // adjust the rate of return based on the error between the net present value and the target value\n      rate -= (targetValue - fv) / fv;\n\n      // recalculate the net present value at the new rate of return\n      fv = this.calcfv(rate, dataTable, n);\n      console.log(fv);\n      iterations++;\n    }\n\n    if (iterations === maxIterations) {\n      throw new Error('Could not find a solution within the maximum number of iterations');\n    }\n    return rate;\n\n  }\n\n  calcfv(r, initialValue, dataTable, n) {\n    let fv = initialValue;\n    for (var i = 0; i < n; i++) {\n      fv = this.finance.FV(r, dataTable[i].balEOY - dataTable[i].mngFee, 1);\n    }\n    return fv;\n  }\n}\n\nexport default GoalSeek;\n"]},"metadata":{},"sourceType":"module"}